/*! darkbox 2014-05-01 */

!function(a,b){"use strict";function c(){var a,c,d=g[h],e=b.Deferred(),f=e.promise();return a=b("<img/>").prop("src",d.src).on("load",function(){console.log("load "+this.width+" "+this.height),d.size={w:this.width,h:this.height},e.resolve(this)}).on("error",function(){d.size={w:400,h:300},c=b('<img src="images/not_found.jpg" />')[0],e.reject(c)}),c=a[0],c.complete&&e.resolve(c),f}function d(){var a=b("#db-overlay"),c=a.find(".db-zoom"),d=a.find("img"),e=a.find("figcaption");d.css("opacity",0).hide(),e.css("opacity",0).hide(),c.css({width:i.w+"px",height:i.h+"px","margin-top":-1*i.h/2+"px","margin-left":-1*i.w/2+"px"})}function e(a){var c,d=b("#db-overlay"),e=d.find(".db-zoom"),f=d.find("img"),l=d.find("figcaption"),m={w:k.width(),h:k.height()},n={w:Math.round(.75*m.w),h:Math.round(.75*m.h)},o=g[h];c=o.isLandscape()?o.size.w<n.w?o.size:{w:n.w,h:Math.round(o.size.h*n.w/o.size.w)}:o.size.h<n.h?o.size:{w:Math.round(o.size.w*n.h/o.size.h),h:n.h},d.not(":visible")&&d.show().css("opacity",1),e.animate({width:c.w+"px",marginLeft:-1*c.w/2+"px"},j).animate({height:c.h+"px",marginTop:-1*c.h/2+"px"},j).promise().done(function(){f.replaceWith(a).show().animate({opacity:1},2*j),o.caption.length>0&&l.text(o.caption).show().animate({opacity:1},2*j)}),i=c}var f={esc:27,left:37,right:39},g=[],h=null,i={w:0,h:0},j=200,k=b(a),l={init:function(){b('<div id="db-overlay">').html('<div class="db-zoom"><figure><img/><figcaption/></figure><a class="db-prev" href="#"></a><a class="db-next" href="#"></a></div>').appendTo("body").click(l.dismiss).on("click",".db-prev",l.prev).on("click",".db-next",l.next),b("[data-darkbox]").click(l.zoom).each(function(a){var c=b(this),d=c.prop("href"),e=c.prop("title");c.data("index",a),g.push({src:d,caption:e,isLandscape:function(){return"object"==typeof this.size?this.size.w>this.size.h:void 0}})}),b(document).keyup(function(a){switch(a.keyCode){case f.esc:l.dismiss(a);break;case f.left:l.prev(a);break;case f.right:l.next(a)}})},dismiss:function(a){a.preventDefault(),b("#db-overlay").css("opacity",0).hide(),i={w:0,h:0}},display:function(){d(),c().done(e).fail(e)},next:function(a){a.preventDefault(),a.stopPropagation(),null!==h&&(h++,h>=g.length&&(h=0)),l.display()},prev:function(a){a.preventDefault(),a.stopPropagation(),null!==h&&(h--,0>h&&(h=g.length-1)),l.display()},zoom:function(a){a.preventDefault();var c=b(this),d=parseInt(c.data("index"),10);h=d,l.display()}};b(l.init)}(window,jQuery);
//# sourceMappingURL=darkbox.min.map